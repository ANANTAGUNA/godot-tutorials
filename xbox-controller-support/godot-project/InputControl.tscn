[gd_scene load_steps=4 format=2]

[ext_resource path="res://assets/icons.png" type="Texture" id=1]
[ext_resource path="res://assets/small-ui-font.tres" type="DynamicFont" id=3]

[sub_resource type="GDScript" id=1]
script/source = "extends Control

const KEYBOARD_DEVICE = -1

export(String) var action_name setget set_action_name

onready var icon = $Sprite
onready var name_label = $ActionName

var device_id = -1

func _ready():
	Input.connect(\"joy_connection_changed\", self, \"_joy_connection_changed\")
	if Input.get_connected_joypads().size() > 0:
		self.device_id =  Input.get_connected_joypads()[0]
	icon.frame = InputHelper.get_current_icon_index(device_id, action_name)
	name_label.text = action_name
	
func _joy_connection_changed(device_id:int, connected:bool):
	if connected:
		device_id = device_id
	else:
		device_id = -1
	icon.frame = InputHelper.get_current_icon_index(device_id, action_name)
	self.device_id = device_id
	
func set_action_name(a):
	action_name = a
	if icon != null:
		icon.frame = InputHelper.get_current_icon_index(self.device_id, action_name)
		name_label.text = action_name
"

[node name="InputControl" type="Control"]
margin_right = 240.0
margin_bottom = 135.0
script = SubResource( 1 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Sprite" type="Sprite" parent="."]
texture = ExtResource( 1 )
hframes = 42

[node name="ActionName" type="Label" parent="."]
margin_left = -19.6569
margin_top = 7.39124
margin_right = 21.3431
margin_bottom = 21.3912
custom_fonts/font = ExtResource( 3 )
text = "ActionName"
align = 1
__meta__ = {
"_edit_use_anchors_": false
}
